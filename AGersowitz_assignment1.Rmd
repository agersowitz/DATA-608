---
title: "R Notebook"
output:
  pdf_document: default
  html_notebook: default
  html_document: default
---

**Principles of Data Visualization and Introduction to ggplot2**

I have provided you with data about the 5,000 fastest growing companies in the US, as compiled by Inc. magazine. lets read this in:

```{r}
inc <- read.csv("https://raw.githubusercontent.com/charleyferrari/CUNY_DATA_608/master/module1/Data/inc5000_data.csv", header= TRUE)
```

And lets preview this data:

```{r}
head(inc)
```
```{r}
summary(inc)
```

Think a bit on what these summaries mean. Use the space below to add some more relevant non-visual exploratory information you think helps you understand this data:

Below I used the skim function from the skimr library. It gives a nice clean display of the dimensions, data types, missing values, and a quick histogram for each variable. We can see below that the only field with missing values is the Employees field, it is only missing 12 out of 5001 records so we will need to take this into account when asnwering question 2. The histograms show a uniform distribution for Rank and a a uniform distribution for growth rate, revenue and employees with a smaller range.

```{r}

library(skimr)
skim(inc)

```

## Question 1

Create a graph that shows the distribution of companies in the dataset by State (ie how many are in each state). There are a lot of States, so consider which axis you should use. This visualization is ultimately going to be consumed on a 'portrait' oriented screen (ie taller than wide), which should further guide your layout choices.

The first thought I had on how to display this information was with a bargraph, I believe the output is ok but is difficult to read with the number of states clogging up the information.

```{r}
library(ggplot2)

state_count<- inc %>% group_by(State) %>% tally()

p <- ggplot(state_count, aes(x = n, y= reorder(State, n))) +
        geom_bar(stat = "identity",width=1,fill='light blue')+ theme(aspect.ratio=16/9)+
        theme(text = element_text(size=8),
        axis.text.y = element_text(angle=0, hjust=1))  +
        geom_text(size=1.9,aes(label=n), position=position_dodge(width=.25), hjust=1)+
        theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))+
        xlab("Count of Companies")+
        ylab("State")+
        ggtitle("5,000 Fastest Growing Comapnies in the US by State")

p


```

## Quesiton 2

Lets dig in on the state with the 3rd most companies in the data set. Imagine you work for the state and are interested in how many people are employed by companies in different industries. Create a plot that shows the average and/or median employment by industry for companies in this state (only use cases with full data, use R's `complete.cases()` function.) In addition to this, your graph should show how variable the ranges are, and you should deal with outliers.

Some of the companies in the dataset for New York have some extreme outliers. I used the boxplot function to identify outliers and remove them from my population.

```{r}
library(ggplot2)

complete_inc<-inc[complete.cases(inc), ]
inc_ny <- filter(complete_inc, State == 'NY')

outliers <- boxplot(inc_ny$Employees, plot=FALSE)$out
inc_ny<- inc_ny[-which(inc_ny$Employees %in% outliers),]

ggplot(inc_ny, aes(x = factor(Industry), y = Employees)) +
  geom_boxplot() +
  stat_summary(fun = "mean", geom = "point", shape = 23, size = 3, fill = "white")+
   theme(
    panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(),
    axis.text.x = element_text(angle = 60, hjust = 1)
  ) 
```

## Question 3

Now imagine you work for an investor and want to see which industries generate the most revenue per employee. Create a chart that makes this information clear. Once again, the distribution per industry should be shown.

```{r}
# Answer Question 3 here
```
Links:

https://stackoverflow.com/questions/16961921/plot-data-in-descending-order-as-appears-in-data-frame
https://stackoverflow.com/questions/12018499/how-to-put-labels-over-geom-bar-for-each-bar-in-r-with-ggplot2
https://felixfan.github.io/ggplot2-remove-grid-background-margin/
https://stackoverflow.com/questions/18252827/increasing-area-around-plot-area-in-ggplot2

https://www.r-bloggers.com/2020/01/how-to-remove-outliers-in-r/
